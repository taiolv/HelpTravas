@model IEnumerable<SuporteIA.Models.Historico>
@{
    ViewData["Title"] = "Histórico do Chamado";
    var chamado = ViewBag.Chamado as SuporteIA.Models.Chamado;
}

<h3 class="mb-3">
    Histórico do Chamado: <span class="text-primary">@chamado?.NmProblema</span>
</h3>

@if (TempData["Mensagem"] != null)
{
    <div class="alert alert-success">@TempData["Mensagem"]</div>
}
@if (TempData["Erro"] != null)
{
    <div class="alert alert-danger">@TempData["Erro"]</div>
}

<table class="table table-bordered table-striped align-middle">
    <thead class="table-dark">
        <tr>
            <th>ID</th>
            <th>Mensagem</th>
            <th>Solução</th>
            <th>Status</th>
            <th>Data</th>
            <th>Ações</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var h in Model)
        {
            <tr>
                <td>@h.CdHistorico</td>
                <td>@h.MensagemArquivada</td>
                <td>@h.FkMensagemSolucao</td>
                <td>@h.FkNmStatus</td>
                <td>@h.DataRegistro.ToString("dd/MM/yyyy HH:mm")</td>
                <td>
                    <form asp-action="Delete" method="post" style="display:inline;">
                        <input type="hidden" name="cdHistorico" value="@h.CdHistorico" />
                        <input type="hidden" name="cdChamado" value="@h.FkCdChamado" />
                        <button type="submit" class="btn btn-danger btn-sm"
                                onclick="return confirm('Excluir este registro do histórico?');">
                            <i class="bi bi-trash"></i> Excluir
                        </button>
                    </form>
                </td>
            </tr>
        }
    </tbody>
</table>

<a asp-controller="Chamado" asp-action="Index" class="btn btn-secondary mt-3">
    <i class="bi bi-arrow-left"></i> Voltar para Chamados
</a>

<a asp-action="Create" asp-route-cdChamado="@chamado?.CdChamado" class="btn btn-success mt-3 ms-2">
    <i class="bi bi-plus-circle"></i> Novo Registro
</a>
